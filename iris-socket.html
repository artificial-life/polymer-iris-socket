<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iris-polymer-importer/iris-importer.html">

<dom-module id="iris-socket">
  <template>
  </template>

  <script>
    'use strict';
    let method = {
      name: "socket",
      request: function(uri, data) {
        return new Promise(function(resolve, reject) {
          if (uri == '/login') {
            resolve({
              token: '12345' + data.login + data.password
            });
          }

          if (uri == '/userinfo') {
            resolve({
              name: 'Ивана',
              lastname: 'Иванова',
              id: 123
            });
          }
        });
      },
      subscribe: function(uri, callback) {

      },
      unsubscribe: function(uri, callback) {

      }
    };

    (function() {
      Polymer({
        is: 'iris-socket',
        properties: {
          api: Object
        },
        ready() {
          //init socket
          let connection = this.api.require('connection');

          connection.addConnectionMethod(method);
        }
      });
    })();
  </script>

</dom-module>